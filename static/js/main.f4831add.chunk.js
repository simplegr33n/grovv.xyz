(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){},211:function(e,t,a){e.exports=a.p+"static/media/corner-logo.5ece3763.png"},244:function(e,t,a){e.exports=a(512)},249:function(e,t,a){},512:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),i=a(40),o=a.n(i),s=(a(249),a(8)),l=a(10),c=a(13),u=a(12),p=a(14),d=(a(21),a(62)),h=a.n(d),m=(a(250),a(252),a(518),{apiKey:"AIzaSyBJuUseKfGN_MjNEWg722WY1FsO2xZ1AuE",authDomain:"grovv-22cbd.firebaseapp.com",databaseURL:"https://grovv-22cbd.firebaseio.com",projectId:"grovv-22cbd",storageBucket:"grovv-22cbd.appspot.com",messagingSenderId:"30272449560"}),f=function e(){Object(s.a)(this,e),h.a.apps.length||h.a.initializeApp(m),this.db=h.a.database(),this.auth=h.a.auth(),this.storage=h.a.storage()},g=a(22),v=a.n(g),S=a(26),E=function(){function e(){Object(s.a)(this,e),this.firebase=new f,this.userID="wR4QKyZ77mho1fL0FQWSMBQ170S2"}return Object(l.a)(e,[{key:"getUser",value:function(e,t){this.firebase.db.ref().child("users").child(e).on("value",function(e){null!==e.val()?t(e.val()):t(!1)},function(e){console.log("get user failed: "+e.code)})}},{key:"setUser",value:function(e){var t=this.firebase.db.ref().child("users").child(e.uid);console.log("DBU",e),t.set(e)}},{key:"getLifetimeData",value:function(e,t){console.log("Get Lifetime Data"),this.firebase.db.ref().child("lifetime").child(this.userID).on("value",function(e){t(e.val())},function(e){console.log("Get Lifetime Data failed: "+e.code)})}},{key:"postLifetimeData",value:function(e,t,a,n,r){console.log("Post Lifetime Data",e),this.firebase.db.ref().child("lifetime").child(this.userID).child(t).child(a).child(n).child(r).set(e)}},{key:"getMonthChunk",value:function(e,t,a,n){console.log("getMonthCHunk!"+e+" "+t+" "+a),this.firebase.db.ref().child("grow_data").child(this.userID).child(e).child("sensor_data").child(t).child(a).on("value",function(e){n(e.val())},function(e){console.log("getMonthChunk: "+e.code)})}},{key:"getLiveGrowData",value:function(){var e=Object(S.a)(v.a.mark(function e(t,a){var n=this;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach(function(e){n.firebase.db.ref().child("grow_data").child(n.userID).child(e.id).child("live_data").on("value",function(t){a(e.id,t.val())},function(t){console.log("follow "+e+" live failed: "+t.code)})});case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getThreeDays",value:function(){var e=Object(S.a)(v.a.mark(function e(t,a){var n,r,i,o,s,l,c,u,p,d;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.firebase.db.ref().child("grow_data").child(this.userID).child(t).child("sensor_data"),r=new Date,i=r.getFullYear().toString(),(o=(r.getMonth()+1).toString()).length<2&&(o="0"+o),s=[],l=null,(c=r.getDate())-2>=1&&((l=c-2).toString().length<2&&(l="0"+l),s[s.length]=l),c-1>=1&&((l=c-1).toString().length<2&&(l="0"+l),s[s.length]=l),c.toString().length<2&&(c="0"+c),s[s.length]=c,u=0,p=[],d=[],s.forEach(function(e){e.toString()!==c.toString()&&n.child(i).child(o).child(e).on("value",function(r){d.includes(e)||(d[d.length]=e,r.forEach(function(e){e.forEach(function(e){if(++u%10===0||0===u){var t=e.val(),a=new Date(t.time).getTime();t.time=a,p[p.length]=t}})}),d.length===s.length-1&&n.child(i).child(o).child(c).on("value",function(e){var n=[];e.forEach(function(e){e.forEach(function(e){if(++u%10===0||0===u){var t=e.val(),a=new Date(t.time).getTime();t.time=a,n[n.length]=t}})}),n.sort(function(e,t){return e.time>t.time?1:-1}),console.log("DBHELPER Test 3-day Datapoints to return... grow:"+t),console.log(n.length),console.log(n[0]),console.log(n[n.length-1]);var r=p.concat(n);r.sort(function(e,t){return e.time>t.time?1:-1}),a(r)}))})});case 16:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getThreeDayData",value:function(e,t){var a=this.firebase.db.ref().child("grow_data").child(this.userID).child(e).child("sensor_data"),n=new Date,r=n.getFullYear().toString(),i=(n.getMonth()+1).toString();i.length<2&&(i="0"+i);var o=[],s=null,l=n.getDate();l-2>=1&&((s=l-2).toString().length<2&&(s="0"+s),o[o.length]=s),l-1>=1&&((s=l-1).toString().length<2&&(s="0"+s),o[o.length]=s),l.toString().length<2&&(l="0"+l),o[o.length]=l,o.forEach(function(n){a.child(r).child(i).child(n).on("value",function(a){var r=[];a.forEach(function(e){e.forEach(function(e){var t=e.val();t.time=1e3*t.time,r[r.length]=t})}),r.sort(function(e,t){return e.time>t.time?1:-1}),t(e,n,r)})})}},{key:"getGrowConfig",value:function(e,t){this.firebase.db.ref().child("grows").child(this.userID).child(e).child("config").on("value",function(e){null!==e.val()?t(e.val()):t(!1)},function(e){console.log("watch isResetting failed: "+e.code)})}},{key:"setGrowConfig",value:function(e,t){this.firebase.db.ref().child("grows").child(this.userID).child(e).child("config").update(t)}},{key:"getResetValue",value:function(e,t){this.firebase.db.ref().child("grows").child(this.userID).child(e).child("config").child("isResetting").on("value",function(e){null!==e.val()?t(e.val()):t(!1)},function(e){console.log("watch isResetting failed: "+e.code)})}},{key:"resetGrow",value:function(e){this.firebase.db.ref().child("grows").child(this.userID).child(e).child("config").child("isResetting").set(!0)}},{key:"getUserGrows",value:function(e){var t=this;this.firebase.db.ref().child("users").child(this.userID).child("grows").on("value",function(a){var n=[];a.forEach(function(e){e.val().sensors_live||(n[n.length]=e.key)});var r=[];n.forEach(function(a){t.firebase.db.ref().child("grows").child(t.userID).child(a).once("value",function(t){r.includes(t.val())||(r[r.length]=t.val()),r.sort(function(e,t){return e.createdAt>t.createdAt?1:-1}),e(r)},function(e){console.log("watch user grows grow failed: "+e.code)})})},function(e){console.log("watch user grows failed: "+e.code)})}},{key:"getLinkedJournals",value:function(e,t){this.firebase.db.ref().child("users").child(this.userID).child("journals").on("value",function(a){var n=[];a.forEach(function(t){e&&Object.keys(e).forEach(function(e){t.val().id===e&&n.push(t.val())})}),n.sort(function(e,t){return e.updatedAt<t.updatedAt?1:-1}),t(n)},function(e){console.log("GrowDetails watch user journals failed: "+e.code)})}},{key:"getUserJournals",value:function(e){this.firebase.db.ref().child("users").child(this.userID).child("journals").on("value",function(t){var a=[];t.forEach(function(e){a.push(e.val())}),console.log("Journals List: ",a),a.sort(function(e,t){return e.updatedAt<t.updatedAt?1:-1}),e(a)},function(e){console.log("watch user journals failed: "+e.code)})}},{key:"watchJournalEntries",value:function(e,t){var a=this.firebase.db.ref().child("journals").child(this.userID).child(e).child("entries");console.log("watchin... "+e),a.on("value",function(e){var a=[];e.forEach(function(e){a.push(e.val())}),a.sort(function(e,t){return e.datetime_true>t.datetime_true?1:-1});var n=[];a.forEach(function(e){n.includes(e.datetime_short)||(n[n.length]=e.datetime_short)});var r=[];n.forEach(function(e){var t=[];a.forEach(function(a){e===a.datetime_short&&(t[t.length]=a)}),r[r.length]=t}),t(a,r)},function(e){console.log("follow journal failed: "+e.code)})}},{key:"createJournal",value:function(){var e=Object(S.a)(v.a.mark(function e(t,a){var n,r,i,o;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.firebase.db.ref().child("journals").child(this.userID).push(),r=this.firebase.db.ref().child("users").child(this.userID).child("journals").child(n.key),i=n.key,o=new Date,n.update({id:i,name:t,updatedAt:o.getTime(),createdAt:o.getTime(),previewImage:"https://via.placeholder.com/160x120?text=NO+PREVIEW"}),r.update({id:i,name:t,updatedAt:o.getTime(),createdAt:o.getTime(),previewImage:"https://via.placeholder.com/160x120?text=NO+PREVIEW"}),a(i);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"saveJournalEntry",value:function(e,t,a,n,r,i,o,s,l){var c=this.firebase.db.ref().child("journals").child(this.userID).child(e).child("entries"),u=(new Date).getTime(),p=a,d=p.getMonth()+1+"-";2===d.length&&(d="0"+d);var h=d+p.getDate()+"-"+p.getFullYear();t||(t=c.push().key);o||(o=new Date),a||(a=new Date),c.child(t).update({id:t,title:n,published:!0,content:r,grow_stage:i,datetime_post:o.getTime(),datetime_edit:u,datetime_true:a.getTime(),datetime_short:h,journal_id:e,images:s}),console.log("set journal entry "+t);var m=this.firebase.db.ref().child("journals").child(this.userID).child(e),f=this.firebase.db.ref().child("users").child(this.userID).child("journals").child(e),g=new Date;m.child("updatedAt").set(g.getTime()),f.child("updatedAt").set(g.getTime()),l(t)}},{key:"handleImageUpload",value:function(){var e=Object(S.a)(v.a.mark(function e(t,a){var n,r,i;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.firebase.storage.ref().child("journals").child(this.userID),console.log("filename:"+t.name),r=new Date,i={contentType:t.type},n.child(r.getTime()+t.name).put(t,i).then(function(e){return e.ref.getDownloadURL()}).then(function(e){var t=e.split("%2F"),n=t[0]+"%2F"+t[1]+"%2Fthumb_"+t[2];a(e,n)});case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleImageDelete",value:function(e){this.firebase.storage.refFromURL(e).delete().then(function(){console.log("deleted "+e+"successfully :)")}).catch(function(t){console.log("delete "+e+"error :(")})}}]),e}(),D=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleUsernameChange=function(e){a.setState({username:e.target.value})},a.handlePasswordChange=function(e){a.setState({password:e.target.value})},a.handleSubmit=function(){console.log("SignIn submit pressed");var e=a.state.username,t=a.state.password;console.log("SignUp submit pressed - username ".concat(e)),a.validateEmail(e)?(a.setState({username:"",password:""}),a.hideSigninFields(),a.firebase.auth.signInWithEmailAndPassword(e,t).catch(function(e){var t=e.code,a=e.message;console.log("".concat(t,": ").concat(a)),alert("".concat(t,": ").concat(a)),this.setState({SHOWFIELDS:!0})}),console.log("username ".concat(e," - logged in"))):alert("Bad email me thinks :(")},a.hideSigninFields=function(){a.setState({SHOWFIELDS:!1})},a.showSigninFields=function(){a.setState({SHOWFIELDS:!0})},a.state={username:"",password:"",SHOWFIELDS:!1},a.firebase=new f,a.firebase.auth.onAuthStateChanged(function(e){e||a.showSigninFields()}),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"validateEmail",value:function(e){return/^\S+@\S+$/.test(String(e).toLowerCase())}},{key:"validatePassword",value:function(e){return/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{7,15}$/.test(String(e))}},{key:"enterSubmit",value:function(){console.log("SignIn submit enter pressed");var e=this.state.username,t=this.state.password;console.log("SignUp submit enter pressed - username ".concat(e)),this.validateEmail(e)?(this.setState({username:"",password:""}),this.hideSigninFields(),this.firebase.auth.signInWithEmailAndPassword(e,t).catch(function(e){var t=e.code,a=e.message;console.log("".concat(t,": ").concat(a)),alert("".concat(t,": ").concat(a)),this.setState({SHOWFIELDS:!0})}),console.log("username ".concat(e," - logged in"))):alert("Bad email me thinks :(")}},{key:"render",value:function(){var e=this;return this.state.SHOWFIELDS?r.a.createElement("div",{id:"signin-div"},r.a.createElement("h3",null,"Sign In"),r.a.createElement("div",null,"Email:",r.a.createElement("input",{id:"signin-username",value:this.state.username,onChange:this.handleUsernameChange})),r.a.createElement("div",null,"Password:",r.a.createElement("input",{type:"password",id:"signin-password",value:this.state.password,onChange:this.handlePasswordChange,onKeyPress:function(t){console.log("Pressed keyCode ".concat(t.key)),"Enter"!==t.key&&"13"!==t.key||e.enterSubmit()}})),r.a.createElement("div",null,r.a.createElement("button",{id:"submit-signin-btn",onClick:this.handleSubmit}," Sign in! "))):r.a.createElement("div",null,"One Moment...")}}]),t}(n.Component),w=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).hideSignupFields=function(){a.setState({SHOWFIELDS:!1})},a.showSignupFields=function(){a.setState({SHOWFIELDS:!0})},a.handleUsernameChange=function(e){a.setState({username:e.target.value})},a.handlePasswordChange=function(e){a.setState({password:e.target.value})},a.handleSubmit=function(){var e=a.state.username,t=a.state.password;return console.log("SignUp submit pressed - username ".concat(e)),a.validateEmail(e)?a.validatePassword(t)?void a.firebase.auth.createUserWithEmailAndPassword(e,t).catch(function(e){var t=e.code,a=e.message;console.log("".concat(t,": ").concat(a))}):(alert("Bad password. Must be 7-15 characters with at least 1 numeric digit and a special character."),void a.setState({password:""})):(alert("Bad email me thinks :("),void a.setState({username:""}))},a.handleGotoSignIn=function(){a.props.gotoSignIn("signin"),console.log("Goto signin pressed")},a.state={username:"",password:"",SHOWFIELDS:!1},a.firebase=new f,a.firebase.auth.onAuthStateChanged(function(e){e?a.postUserToFirebase(e.uid,e.email):a.showSignupFields()}),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"postUserToFirebase",value:function(e,t){var a=(new Date).getTime(),n={uid:e,username:t,createdAt:a,updatedAt:a},r={};return r["/users/"+e]=n,this.firebase.db.ref().update(r)}},{key:"validateEmail",value:function(e){return/^\S+@\S+$/.test(String(e).toLowerCase())}},{key:"validatePassword",value:function(e){return/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{7,15}$/.test(String(e))}},{key:"render",value:function(){return this.state.SHOWFIELDS?r.a.createElement("div",{id:"signup-div"},r.a.createElement("h3",null,"Sign Up"),r.a.createElement("div",null,"Email:",r.a.createElement("input",{id:"signup-username",value:this.state.username,onChange:this.handleUsernameChange})),r.a.createElement("div",null,"Password:",r.a.createElement("input",{type:"password",id:"signup-password",value:this.state.password,onChange:this.handlePasswordChange})),r.a.createElement("div",null,r.a.createElement("button",{id:"submit-signup-btn",onClick:this.handleSubmit}," Sign up! ")),r.a.createElement("div",null,r.a.createElement("button",{id:"goto-signin-btn",onClick:this.handleGotoSignIn}," Sign in! "))):r.a.createElement("div",null,"One Moment...")}}]),t}(n.Component),y=a(199),I=a.n(y),b=(a(256),a(214)),G=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleContentChange=function(e){a.setState({content:e.target.value})},a.cancelModal=function(){a.deleteAllAddedImages(),a.props.closeModal(a.state.entryID)},a.saveEntry=Object(S.a)(v.a.mark(function e(){var t,n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a.state.content||0!==a.state.images.length){e.next=3;break}return alert("Needs content or images!"),e.abrupt("return");case 3:a.setState({published:!0}),t=null,t=""!==a.state.title&&a.state.title?a.state.title:"",n=null,n=""!==a.state.content&&a.state.content?a.state.content:"",a.dbHelper.saveJournalEntry(a.state.journalID,a.state.entryID,a.state.trueDate,t,n,a.state.growStage,a.state.postDate,a.state.images,a.closeModal);case 9:case"end":return e.stop()}},e)})),a.closeModal=function(e){a.props.closeModal(e)},a.displayFullImage=function(){console.log("JournalAddEditModal todo")},a.handleImageUpload=function(){var e=Object(S.a)(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.dbHelper.handleImageUpload(t,a.setImages);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return","caught "+e.t0);case 9:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.setImages=function(e,t){var n=a.state.images,r=a.state.addedImages;n.push({url:e,thumb:t}),r.push({url:e,thumb:t}),a.setState({images:n,addedImages:r})},a.deleteImage=function(e){var t=e.target.dataset.value;console.log(t),console.log(a.state.images);var n=[];a.state.images.forEach(function(e){e.url.toString()===t?(a.handleImageDelete(e.url),a.handleImageDelete(e.thumb)):n.push(e)}),a.setState({images:n})},a.deleteAllAddedImages=function(){a.state.addedImages.forEach(function(e){a.handleImageDelete(e.url),a.handleImageDelete(e.thumb)})},a.handleImageDelete=function(e){a.dbHelper.handleImageDelete(e)},a.handleDateChange=function(e){a.setState({trueDate:e})},a.handleGrowStageChange=function(e){a.setState({growStage:e.target.value})},a.state={title:"",content:"",images:[],addedImages:[],journalID:a.props.journalID,postDate:new Date,trueDate:new Date,growStage:"veg",published:!1,entryID:""},a.dbHelper=new E,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.props.editPost){var e=null;e=this.props.editPost.datetime_true?new Date(this.props.editPost.datetime_true):this.state.trueDate;var t=null;t=this.props.editPost.datetime_post?new Date(this.props.editPost.datetime_post):this.state.postDate;var a=this.props.editPost.content,n=this.props.editPost.title,r=this.props.editPost.images;null!==r&&void 0!==r||(r=[]);var i=null;i=this.props.editPost.grow_stage?this.props.editPost.grow_stage:this.state.growStage;var o=this.props.editPost.id;this.setState({title:n,content:a,trueDate:e,postDate:t,growStage:i,images:r,entryID:o,published:!0})}}},{key:"onImageDrop",value:function(e){var t=this;console.log(e),e.forEach(function(e){t.handleImageUpload(e),console.log("upload "+e)})}},{key:"render",value:function(){var e=this;if(console.log("true DATE!!"),console.log(this.state.trueDate),this.state.images)var t=this.state.images.map(function(t,a){return r.a.createElement("div",{className:"Temp-Image-Div"},r.a.createElement("img",{key:a,alt:"grow img","data-value":t.url,src:t.url,className:"Journal-Entry-Preview-Thumbnail",onClick:e.displayFullImage}),r.a.createElement("div",{"data-value":t.url,onClick:e.deleteImage,className:"Delete-Image-Btn"},"X"))});return r.a.createElement("div",{id:"Journal-Modal-Space"},r.a.createElement("div",{id:"Journal-Edit-Entry-Modal"},r.a.createElement("div",{id:"Journal-Edit-Topline"},r.a.createElement(I.a,{id:"journal-edit-datepicker",selected:this.state.trueDate,onChange:this.handleDateChange}),r.a.createElement("select",{id:"journal-edit-grow-stage",onChange:this.handleGrowStageChange,value:this.state.growStage},r.a.createElement("option",{value:"post"},"Post"),r.a.createElement("option",{value:"flower"},"Flower"),r.a.createElement("option",{value:"veg"},"Veg"),r.a.createElement("option",{value:"seedling"},"Seedling"),r.a.createElement("option",{value:"pre"},"Pre")),r.a.createElement("input",{className:"journal-modal-edit-title",placeholder:"enter title...",value:this.state.title,onChange:this.handleTitleChange})),r.a.createElement("textarea",{className:"journal-modal-edit-body",placeholder:"enter body content...",value:this.state.content,onChange:this.handleContentChange}),r.a.createElement("div",{className:"journal-add-images-area"},r.a.createElement(b.a,{className:"journal-add-images-dropzone",onDrop:this.onImageDrop.bind(this),accept:"image/*",multiple:!0},function(e){var t=e.getRootProps,a=e.getInputProps;return r.a.createElement("div",t(),r.a.createElement("input",a()),r.a.createElement("p",{id:"Image-Drop-Text"},"Try dropping some ",r.a.createElement("br",null)," images ",r.a.createElement("span",{role:"img","aria-label":"camera"},"\ud83d\udcf7")," here, ",r.a.createElement("br",null),"or click to ",r.a.createElement("br",null)," select files."))}),function(){if(t)return r.a.createElement("div",{className:"Journal-Edit-Post-Images"},t)}()),r.a.createElement("div",{id:"journal-cancel-save-btns"},r.a.createElement("button",{className:"journal-cancel-btn",onClick:this.cancelModal},"Cancel"),r.a.createElement("button",{className:"journal-save-entry-btn",onClick:this.saveEntry},"Save Entry"))))}}]),t}(n.Component),O=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).closeModal=function(){a.props.closeModal("")},a.nextImage=function(){a.state.fullSizeList.forEach(function(e,t){e!==a.state.currentImage||t<a.state.fullSizeList.length-1&&a.setState({currentImage:a.state.fullSizeList[t+1]})})},a.previousImage=function(){a.state.fullSizeList.forEach(function(e,t){e!==a.state.currentImage||t>0&&a.setState({currentImage:a.state.fullSizeList[t-1]})})},a.state={imageList:a.props.imageList,currentImage:a.props.currentFullImage,fullSizeList:[]},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.props.imageList){var e=[];this.props.imageList.forEach(function(t){e[e.length]=t.url}),this.setState({fullSizeList:e})}}},{key:"render",value:function(){return console.log("FULLIMAGE MODAL!"),console.log(this.state.imageList),console.log(this.state.currentImage),r.a.createElement("div",{id:"Full-Image-Modal-Space"},r.a.createElement("img",{id:"Full-Image-Image",alt:"full size",src:this.state.currentImage}),r.a.createElement("button",{onClick:this.closeModal,id:"Full-Image-Close-Btn"},"x"),r.a.createElement("button",{onClick:this.previousImage,id:"Full-Image-Last-Btn"},"\u2264"),r.a.createElement("button",{onClick:this.nextImage,id:"Full-Image-Next-Btn"},"\u2265"))}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleJournalNameChange=function(e){a.setState({journalName:e.target.value})},a.cancelModal=function(){a.props.setJournalID(null)},a.createJournal=Object(S.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==a.state.journalName){e.next=3;break}return alert("Journal needs a name!"),e.abrupt("return");case 3:return e.prev=3,e.next=6,a.dbHelper.createJournal(a.state.journalName,a.openJournal);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return","caught "+e.t0);case 12:case"end":return e.stop()}},e,null,[[3,8]])})),a.openJournal=function(e){a.setState({journalID:e}),a.props.setJournalID(e)},a.state={journalName:"",journalID:a.props.journalID},a.dbHelper=new E,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{id:"Journal-Modal-Space"},r.a.createElement("div",{id:"Journal-Create-Modal"},r.a.createElement("input",{className:"journal-modal-journal-name",placeholder:"enter journal name...",value:this.state.journalName,onChange:this.handleJournalNameChange}),r.a.createElement("div",{id:"journal-create-btns"},r.a.createElement("button",{className:"journal-cancel-create-btn",onClick:this.cancelModal},"Cancel"),r.a.createElement("button",{className:"journal-create-journal-btn",onClick:this.createJournal},"Create Journal"))))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).setEntries=function(){a.props.setEntries(a.props.entries)},a.state={journalName:"",journalID:a.props.journalID,monthDayDate:""},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.props.entry){var e=new Date(this.props.entry.datetime_true),t=e.getMonth()+1+"-";2===t.length&&(t="0"+t);var a=t+e.getDate();this.setState({monthDayDate:a})}}},{key:"render",value:function(){var e=this,t=this.props.entry.grow_stage,a="Timeline-Dot-"+t.charAt(0).toUpperCase()+t.slice(1),n=!1;this.props.currentEntryID===this.props.entry.id&&(n=!0);var i=this.props.entry.datetime_short.split("-"),o=i[0]+"-"+i[1],s=new Date(this.props.entry.datetime_true).toDateString(),l=null;return this.props.entries[0].images&&(l=this.props.entries[0].images[0].thumb),r.a.createElement("div",null,function(){if(n)return r.a.createElement("div",{className:"Timeline-Dot-Connector"},r.a.createElement("div",{className:"Dot-Connector-Text-rotate-180"},o))}(),r.a.createElement("button",{"data-value":this.props.entries,id:a,className:"Timeline-Dot",onClick:this.setEntries},function(){if(!n)return r.a.createElement("div",{className:"Dot-Preview-rotate-180"},r.a.createElement("div",{className:"Dot-Preview-Window"},r.a.createElement("div",{className:"Dot-Preview-Date-String"},s),function(){if(l)return r.a.createElement("img",{alt:"journal preview",src:l,className:"Preview-Image-Thumbnail",onClick:e.displayFullImage})}()))}()))}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).openJournal=function(){a.props.openJournal(a.props.journal)},a.state={journal:a.props.journal},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=new Date(this.props.journal.createdAt).toDateString(),t=new Date(this.props.journal.updatedAt),a=t.getHours().toString();1===a.length&&(a="0"+a);var n=t.getMinutes().toString();1===n.length&&(n="0"+n);var i=t.toDateString()+" - "+a+":"+n;return r.a.createElement("div",{className:"Journal-Box-Item","data-value":this.props.journal.id,onClick:this.openJournal},r.a.createElement("div",{className:"Journal-Box-Item-Main"},r.a.createElement("div",{className:"Journal-Box-Item-Header"},r.a.createElement("div",null,this.props.journal.name),r.a.createElement("div",{className:"Journal-Box-Created"},"updated: ",r.a.createElement("i",null,r.a.createElement("b",null,i)))),r.a.createElement("div",{className:"Journal-Box-Info"},"created: ",r.a.createElement("i",null,r.a.createElement("b",null,e)))),r.a.createElement("img",{alt:"preview",src:this.props.journal.previewImage,className:"Journal-Box-Preview-Image"}))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).displayFullImage=function(e){a.props.displayFullImage(a.props.currentEntry.images),a.props.currentFullImage(e.target.dataset.value)},a.editEntryByID=function(e){a.props.editEntryByID(e.target.dataset.value)},a.state={},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){this.state.currentEntry&&this.state.currentEntry.id===e.currentEntry.id||this.setState({currentEntry:e.currentEntry})}},{key:"render",value:function(){var e=this,t=null;this.props.currentEntry&&this.props.currentEntry.images&&(t=this.props.currentEntry.images.map(function(t,a){return r.a.createElement("img",{key:a,alt:"grow img","data-value":t.url,src:t.thumb,className:"Journal-Entry-Thumbnail",onClick:e.displayFullImage})}));var a=null;return this.props.currentEntry&&""!==this.props.currentEntry&&(a=new Date(this.props.currentEntry.datetime_true)),r.a.createElement("div",{className:"Journal-Post-View"},r.a.createElement("div",{className:"Journal-Post-Header"},r.a.createElement("div",{className:"Journal-Post-Date"},a.toDateString()),r.a.createElement("div",{className:"Journal-Post-Title"},this.props.currentEntry.title),r.a.createElement("button",{className:"Journal-Edit-Post-Btn","data-value":this.props.currentEntry.id,onClick:this.editEntryByID},"edit \u270e")),r.a.createElement("div",{className:"Journal-Post-Content"},this.props.currentEntry.content),function(){if(t)return r.a.createElement("div",{className:"Journal-Post-Images-Wrapper"},r.a.createElement("div",{className:"Journal-Post-Images"},t))}())}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).watchEntries=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.props.journalID;a.dbHelper.watchJournalEntries(e,a.setJournalEntries)},a.setJournalEntries=function(e,t){e.length>0?a.setState({currentEntry:e[e.length-1],currentEntryID:e[e.length-1].id,timelineEntries:e,timelineDots:t,displayEntries:t[t.length-1]}):a.setState({currentEntry:null,currentEntryID:null,timelineEntries:[],timelineDots:[],displayEntries:[]}),a.setEntries(t[t.length-1])},a.addTimelineEntry=function(){a.setState({displayContent:"add"})},a.editEntryByID=function(e){console.log("edit: "+e),console.log(e),a.state.timelineEntries.forEach(function(t){t.id!==e||a.setState({currentEntry:t,currentEntryID:t.id,displayContent:"edit"})})},a.openFullImageModal=function(e){a.setState({displayContent:"full-image",fullImageModalImages:e})},a.openFullImage=function(e){console.log("imageURL"),console.log(e),a.setState({currentFullImage:e})},a.closeModal=function(e){e&&""!==e?(a.setState({displayContent:"main"}),a.state.timelineEntries.forEach(function(t){t.id!==e||a.setState({currentEntry:t,currentEntryID:t.id})})):a.setState({displayContent:"main"})},a.setJournalID=function(e){if(null===e)return a.setState({displayContent:"main"}),void a.props.setJournalID(null);a.setState({displayContent:"main",journalID:e}),a.props.setJournalID(e),a.watchEntries(e)},a.setEntries=function(e){e&&a.setState({currentEntry:e[0],currentEntryID:e[0].id,displayEntries:e})},a.handleJournalChange=function(e){console.log("JOURNAL CHANGE!!!!"),console.log(e.target.value),a.setState({currentEntry:null,currentEntryID:null,displayEntries:[]}),a.props.setJournalID(e.target.value),a.watchEntries(e.target.value)},a.openCreateJournalModal=function(){a.setState({displayContent:"create-journal"})},a.openJournal=function(e){a.setState({journalID:e.id}),a.props.setJournalID(e.id),a.watchEntries(e.id)},a.state={displayContent:"main",displayEntries:[],currentEntry:null,currentEntryID:null,testContent:"",timelineEntries:[],journalID:a.props.journalID,fullImageModalImages:null,currentFullImage:null},a.dbHelper=new E,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0,this.props.journalID&&this.watchEntries(this.props.journalID)}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this,t="";this.props.userJournals.length>0&&(t=this.props.userJournals.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}));var a=null;this.props.userJournals&&(a=this.props.userJournals.map(function(t){return r.a.createElement("div",{key:t.id,className:"Journal-Box-Item-Container"},r.a.createElement(C,{journal:t,openJournal:e.openJournal}))}));var n=null;this.state.displayEntries&&(n=this.state.displayEntries.map(function(t){return r.a.createElement(A,{key:t.id,editEntryByID:e.editEntryByID,currentEntry:t,currentFullImage:e.openFullImage,displayFullImage:e.openFullImageModal})}));var i=null;return this.state.timelineDots&&(i=this.state.timelineDots.map(function(t){return r.a.createElement(k,{key:t[0].datetime_short,currentEntryID:e.state.currentEntryID,setEntries:e.setEntries,entry:t[0],entries:t})})),r.a.createElement("div",{id:"Journal-Page"},r.a.createElement("div",{id:"Journal-Main"},r.a.createElement("div",{id:"Grow-Journal-Main-Area"},a&&!e.props.journalID?r.a.createElement("div",{id:"Journal-Box-Area-Scroll"},r.a.createElement("div",{id:"Grow-Journal-Header-Area"},r.a.createElement("div",{id:"Grow-Journal-Header-Text"},"Grow Journals"),r.a.createElement("button",{className:"New-Journal-Btn",onClick:e.openCreateJournalModal},"+")),r.a.createElement("div",{id:"Journal-Box-Area"},a)):e.props.journalID?void 0:r.a.createElement("div",{id:"Grow-Journal-Header-Area"},r.a.createElement("div",{id:"Grow-Journal-Header-Text"},"Grow Journals"),r.a.createElement("button",{className:"New-Journal-Btn",onClick:e.openCreateJournalModal},"+")),function(){if(t&&e.props.journalID)return r.a.createElement("div",{className:"Grow-Journal-Title-Div"},r.a.createElement("select",{id:"Grow-Journal-Title-Select",onChange:e.handleJournalChange,value:e.props.journalID},t),r.a.createElement("button",{className:"New-Journal-Btn",onClick:e.openCreateJournalModal},"+"))}(),function(){if(e.props.journalID)return r.a.createElement("div",{id:"Journal-Posts-Container"},n?r.a.createElement("div",null,n):r.a.createElement("div",{className:"Journal-Post-View"},"Let's get some journal entries..."))}()),function(){if(e.props.journalID)return r.a.createElement("div",{id:"Timeline-Container"},r.a.createElement("div",{id:"Timeline-Inner-Container"},r.a.createElement("div",{id:"Timeline-Line"}),r.a.createElement("div",{id:"Timeline-Spots"},i,r.a.createElement("button",{id:"Timeline-Add-Dot",onClick:e.addTimelineEntry},"+"))))}()),function(){switch(e.state.displayContent){case"add":return r.a.createElement(G,{journalID:e.props.journalID,closeModal:e.closeModal,editPost:"new"});case"edit":return r.a.createElement(G,{journalID:e.props.journalID,closeModal:e.closeModal,editPost:e.state.currentEntry});case"full-image":return r.a.createElement(O,{closeModal:e.closeModal,imageList:e.state.fullImageModalImages,currentFullImage:e.state.currentFullImage});case"create-journal":return r.a.createElement(x,{journalID:e.props.journalID,setJournalID:e.setJournalID});case"main":default:return r.a.createElement("div",null)}}())}}]),t}(n.Component),N=a(16),R=a(18),P=a.n(R),T=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidUpdate=function(){if(a.props.grow&&a.growConfig!==a.props.grow.config&&(a.growConfig=a.props.grow.config,a.generateTickSourceArrays()),a.props.rawGrowData&&a.props.grow){var e=a.props.grow.id,t=a.props.rawGrowData;if(t[e]&&(!a.rawRef||t[e][t[e].length-1]!==a.rawRef)){a.rawRef=t[e][t[e].length-1];var n=[];t[e].forEach(function(e){n=n.concat(e)}),a.dataLength!==n.length&&(a.dataLength=n.length,n.sort(function(e,t){return e.time>t.time?1:-1}),a.concatData=n,a.processData())}}},a.generateTickSourceArrays=function(){if(a.props.grow.config.LIGHTS){var e=P()(new Date);e.subtract(3,"days");var t=[],n=[];t[t.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.on)).format("x"),n[n.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.off)).format("x"),e.add(1,"days"),t[t.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.on)).format("x"),n[n.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.off)).format("x"),e.add(1,"days"),t[t.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.on)).format("x"),n[n.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.off)).format("x"),e.add(1,"days"),t[t.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.on)).format("x"),n[n.length]=P()(new Date(e.format("L")+" "+a.props.grow.config.LIGHTS.off)).format("x"),a.setState({lightsOnArray:t,lightsOffArray:n}),a.lightsOnArray=t,a.lightsOffArray=n,a.createTickArray()}},a.createTickArray=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.processedData;if(e&&e[0]){var t=[new Date(e[0].time).getTime(),new Date(e[e.length-1].time).getTime()],n=[],r=a.lightsOnArray,i=a.lightsOffArray;if(i||r){var o=r.concat(i);o.sort(function(e,t){return e>t?1:-1}),o.forEach(function(e){e>t[0]&&e<t[1]&&(n[n.length]=e)}),r.includes(n[0])?a.setState({lightBackgrounds:["#7344e740","#fff93640"]}):a.setState({lightBackgrounds:["#fff93640","#7344e740"]}),a.setState({tickArray:n})}}},a.processData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.displayWindow,t=null;if(a.concatData){t=a.concatData;var n=[],r=-1,i=(new Date).getTime(),o=Math.round(e/108e5);o<1&&(o=1),t.forEach(function(t){if(i-t.time<e&&(0===++r||r%o===0)){var a=t;n[n.length]=a}}),a.setState({processedData:n}),a.createTickArray(n)}},a.toggleWindow=function(e){var t=parseInt(e.target.value);a.setState({displayWindow:t}),a.processData(t),a.render()},a.renderTooltip=function(e){var t=e.payload;if(null!==t&&0!==t.length){var n=P()(e.payload[0].payload.time).format("ddd - HH:mm"),i=t.map(function(e){return function(){if(a.props.activeLines){var n=a.props.activeLines.indexOf(e.dataKey),i=a.props.grow.config.SENSORS[n];if(!i)return;return r.a.createElement("div",{className:"Grow-Details-Graph-Tooltip-Data",key:i.PID,style:{color:e.stroke,paddingLeft:"2px",paddingRight:"2px"}},r.a.createElement("div",{style:{color:e.stroke,display:"flex",flexDirection:"row",justifyContent:"space-between"}},r.a.createElement("div",null,e.name,": "),r.a.createElement("div",{style:{fontWeight:600}},t[0].payload[e.dataKey]," ",i.unit)),r.a.createElement("div",{style:{width:"100%",height:"1px",background:"#2d2d2e"}}))}}()});return r.a.createElement("div",{className:"Grow-Details-Graph-Tooltip"},r.a.createElement("div",null,n),i)}},a.state={displayWindow:432e5,lightsOnArray:[],lightsOffArray:[],tickArray:[],lightBackgrounds:["#7344e740","#fff93640"]},a.displayTemp=!0,a.displayFan=!0,a.displayHumidity=!0,a.displayHumidifier=!0,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this,t=this.props.grow.config.SENSORS.map(function(t){return e.props.activeLines&&e.props.activeLines.includes(t.PID)?"airTemp"===t.type||"waterTemp"===t.type||"co2"===t.type?r.a.createElement(N.b,{yAxisId:"left",type:"monotone",name:t.name,dataKey:t.PID,key:t.PID,stroke:t.color,strokeWidth:t.thickness,dot:!1}):r.a.createElement(N.b,{yAxisId:"right",type:"monotone",name:t.name,dataKey:t.PID,key:t.PID,stroke:t.color,strokeWidth:t.thickness,dot:!1}):e.props.activeLines?void 0:"airTemp"===t.type||"waterTemp"===t.type||"co2"===t.type?r.a.createElement(N.b,{yAxisId:"left",type:"monotone",name:t.name,dataKey:t.PID,key:t.PID,stroke:t.color,strokeWidth:t.thickness,dot:!1}):r.a.createElement(N.b,{yAxisId:"right",type:"monotone",name:t.name,dataKey:t.PID,key:t.PID,stroke:t.color,strokeWidth:t.thickness,dot:!1})}),a=null;if(this.state.processedData&&this.state.processedData[0]&&this.props.parentSize){var n=Math.floor(.91*this.props.parentSize[0]),i=Math.floor(.9*this.props.parentSize[1]);a=r.a.createElement(N.c,{width:n,height:i,data:this.state.processedData},t,r.a.createElement(N.a,{vertical:!0,horizontal:!1,verticalFill:[this.state.lightBackgrounds[0],this.state.lightBackgrounds[1]],stroke:"none",fillOpacity:.2}),r.a.createElement(N.e,{tick:{fill:"#B3C2B5"},dataKey:"time",type:"number",domain:[(new Date).getTime(),new Date(new Date-this.state.displayWindow).getTime()],ticks:this.state.tickArray,tickFormatter:function(e){return P()(1*e).format("ddd - HH:mm")}}),r.a.createElement(N.f,{yAxisId:"left",orientation:"left",domain:[24],tick:{fill:"#B3C2B5"}}),r.a.createElement(N.f,{yAxisId:"right",hide:!0,orientation:"right",tick:{fill:"#B3C2B5"}}),r.a.createElement(N.d,{content:this.renderTooltip}))}return r.a.createElement("div",{className:"Chart-Container"},a,r.a.createElement("div",{style:{width:"40px",fontSize:"0.55em",display:"flex",flexDirection:"column",position:"absolute",marginLeft:"2.5%",marginTop:"4%"}},r.a.createElement("select",{onChange:this.toggleWindow,id:"GraphSensors-Time-Scale",defaultValue:432e5,style:{fontSize:"0.8em",maxWidth:"74px",height:"20px"}},r.a.createElement("option",{value:18e5},"\xbdh"),r.a.createElement("option",{value:108e5},"3h"),r.a.createElement("option",{value:432e5},"12h"),r.a.createElement("option",{value:864e5},"24h"),r.a.createElement("option",{value:2592e5},"72h"))))}}]),t}(n.Component),L=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={elementSize:[]},a.graphSizeUpdated=0,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0}},{key:"componentDidUpdate",value:function(){if(!1!==this._ismounted){var e=new Date;if(this.state.elementSize!==[this.divRef.clientWidth,this.divRef.clientHeight]&&e.getTime()-this.graphSizeUpdated>500){var t=[this.divRef.clientWidth+this.divRef.clientWidth/100*10,this.divRef.clientHeight+this.divRef.clientHeight/100*14];t!==this.state.elementSize&&(this.setState({elementSize:t}),this.graphSizeUpdated=e.getTime())}}}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{position:"relative",width:"100vw",height:"80vh",minHeight:"80vh",background:"#000"},ref:function(t){return e.divRef=t}},r.a.createElement(T,{activeLines:this.props.activeLines,parentSize:this.state.elementSize,rawGrowData:this.props.rawGrowData,grow:this.props.grow}))}}]),t}(n.Component),_=a(99),F=a(23),H=a(25),M=a(70),z=a.n(M),W=a(71),J=a.n(W),B=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentWillUnmount=function(){a._ismounted=!1},a.componentDidUpdate=function(){if(a.props.threeDayData){if(!a.props.threeDayData[a.props.grow.id])return;if(a.props.grow!==a.state.GROW){a.harmonyRatiosUpdated=null;for(var e=[],t=[],n=0,r=Object.entries(a.props.grow.config.SENSORS);n<r.length;n++){var i=r[n],o=Object(F.a)(i,2),s=(o[0],o[1]);e[s.PID]=s._deviation,t[s.PID]=s._mean}a.setState({GROW:a.props.grow,SENSOR_DEVIATIONS:e,SENSOR_MEANS:t})}var l=a.props.threeDayData[a.props.grow.id][a.props.threeDayData[a.props.grow.id].length-1].length;a.dataLengthRef!==l?(a.dataLengthRef=l,a.processGrowData(a.props.threeDayData)):a.state.TABLE_INIT||(a.dataLengthRef=l,a.processGrowData(a.props.threeDayData),a.setState({TABLE_INIT:!0}))}},a.processGrowData=function(e){var t=[];e[a.props.grow.id].forEach(function(e){t=t.concat(e)}),t.sort(function(e,t){return e.time>t.time?1:-1}),a.setState({liveData:t[t.length-1],lastLiveData:t[t.length-2]});var n=(new Date).valueOf(),r=[],i=[],o=[],s=[],l=[],c=[],u=0,p=0,d=[],h=[],m=[];a.state.SENSORS_INIT!==a.props.grow&&a.props.grow.config.SENSORS!==a.state.SENSOR_PIDS&&(a.props.grow.config.SENSORS.forEach(function(e,t){m[t]!==e.PID&&(m[t]=e.PID)}),a.setState({SENSOR_PIDS:m}),a.state.ACTIVE_INIT!==a.props.grow&&a.setState({ACTIVE_INIT:a.props.grow})),t.forEach(function(e){if(n-e.time<864e5)for(var t in u+=1,d[d.length]=e,e)if(m.includes(t)){var a=m.indexOf(t);(!r[a]||parseFloat(e[t])>=r[a])&&(r[a]=e[t],i[a]=e.time),(!o[a]||parseFloat(e[t])<=o[a])&&(o[a]=e[t],s[a]=e.time),l[a]||(l[a]=0),l[a]=parseFloat(e[t])+parseFloat(l[a])}if(n-e.time<1728e5&&n-e.time>864e5)for(var f in p+=1,h[h.length]=e,e)if(m.includes(f)){var g=m.indexOf(f);c[g]||(c[g]=0),c[g]=parseFloat(e[f])+parseFloat(c[g])}}),l.forEach(function(e,t){l[t]=l[t]/u}),c.forEach(function(e,t){c[t]=c[t]/p}),a.setState({DAILY_HIGHS:r,DAILY_HIGHS_TIMES:i,DAILY_LOWS:o,DAILY_LOWS_TIMES:s,DAILY_AVGS:l,YEST_AVGS:c}),a.processDeviationData(t,n)},a.processDeviationData=function(e,t){var n=[],r=[],i=[];if(e.forEach(function(e){if(t-e.time<864e5)for(var o=0,s=Object.entries(a.props.grow.config.SENSORS);o<s.length;o++){var l=s[o],c=Object(F.a)(l,2),u=(c[0],c[1]),p=u.PID;n[p]||(n[p]=0,r[p]=0,i[p]=0),n[p]=n[p]+1,e[p]>u._mean+2*u._deviation||e[p]<u._mean-2*u._deviation?i[p]=i[p]+1:(e[p]>u._mean+u._deviation||e[p]<u._mean-u._deviation)&&(r[p]=r[p]+1)}}),0!==Object.keys(n).length){a.harmonyRatiosUpdated=(new Date).valueOf();for(var o=0,s=Object.entries(r);o<s.length;o++){var l=s[o],c=Object(F.a)(l,2),u=c[0];c[1];r[u]=Math.round(r[u]/n[u]*100)}for(var p=0,d=Object.entries(i);p<d.length;p++){var h=d[p],m=Object(F.a)(h,2),f=m[0];m[1];i[f]=Math.round(i[f]/n[f]*100)}a.setState({HARMONY_DANGER:i,HARMONY_WARN:r})}},a.toggleLine=function(e){var t=e.currentTarget.getAttribute("data-value");a.props.toggleLine(t+"^"+a.props.grow.id)},a.state={SENSOR_PIDS:[],SENSORS_INIT:!1,DAILY_HIGHS:[],DAILY_HIGHS_TIMES:[],DAILY_LOWS:[],DAILY_LOWS_TIMES:[],DAILY_AVGS:[],YEST_AVGS:[],ACTIVE_LINES:[],ACTIVE_INIT:!1,TABLE_INIT:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this._ismounted=!0,this.props.grow&&!this.state.SENSOR_DEVIATIONS){for(var e=[],t=[],a=0,n=Object.entries(this.props.grow.config.SENSORS);a<n.length;a++){var r=n[a],i=Object(F.a)(r,2),o=(i[0],i[1]);e[o.PID]=o._deviation,t[o.PID]=o._mean}this.setState({SENSOR_DEVIATIONS:e,SENSOR_MEANS:t})}if(this.props.threeDayData&&this.state.SENSOR_PIDS&&this.state.SENSOR_MEANS){if(!this.props.threeDayData[this.props.grow.id])return;var s=this.props.threeDayData[this.props.grow.id][this.props.threeDayData[this.props.grow.id].length-1].length;this.dataLengthRef!==s&&(this.dataLengthRef=s,this.processGrowData(this.props.threeDayData)),this.forceUpdate()}}},{key:"render",value:function(){var e=this,t="#FFF";if(this.props.liveGrowData&&this.props.liveGrowData[this.props.grow.id]){var a=(new Date).getTime(),n=new Date(1e3*this.props.liveGrowData[this.props.grow.id].time);this.updatedAtDate&&n!==this.updatedAtDate[this.props.grow.id]&&(this.updatedAtDate[this.props.grow.id]=n);var i=a-1e3*this.props.liveGrowData[this.props.grow.id].time;i>1e7?t="#989e98":i>3e5?t="#fa360a":i>6e4?t="#facb23":i<6e4&&(t="#27d927"),P()(n).fromNow()}var o=this.state.SENSOR_PIDS.map(function(t){return r.a.createElement("div",{className:"Grow-Details-Main-Data-Display-Row",key:t},function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a],i=t+"^"+e.props.grow.id,o=1,s="4px";if(!e.props.activeLines&&e.props.user&&e.props.user.PREFS&&e.props.user.PREFS.GRAPHS&&e.props.user.PREFS.GRAPHS.AllGraph&&e.props.user.PREFS.GRAPHS.AllGraph.showSensors&&!1===e.props.user.PREFS.GRAPHS.AllGraph.showSensors[i]&&(o=.3,s="3px"),e.props.activeLines&&!e.props.activeLines.includes(t)&&(o=.3,s="3px"),e.props.grow.config.SENSORS[a])return r.a.createElement("div",{"data-value":t,key:t,onClick:e.toggleLine,style:{width:"120px",maxHeight:"100%",display:"flex",flexDirection:"row",justifyContent:"flex-end",fontSize:"0.65em",cursor:"pointer",background:"#0c140d",opacity:o,color:e.props.grow.config.SENSORS[a].color}},r.a.createElement("div",{style:{paddingTop:s,fontSize:"12px",lineHeight:"12px",overflow:"hidden",fontWeight:"500"}}," ",n.name),"airTemp"===n.type?r.a.createElement(H.d,{style:{color:"#FFF",fontSize:"30px"}}):"humidity"===n.type?r.a.createElement(H.b,{style:{color:"#FFF",fontSize:"30px"}}):"fan"===n.type?r.a.createElement(H.c,{style:{color:"#FFF",fontSize:"30px"}}):"humidifier"===n.type?r.a.createElement(H.a,{style:{color:"#FFF",fontSize:"30px"}}):"waterTemp"===n.type?r.a.createElement(H.e,{style:{color:"#FFF",fontSize:"30px"}}):"co2"===n.type?r.a.createElement("img",{src:z.a,alt:"CO2 Icon",style:{position:"relative",display:"inline-block",maxHeight:"28px"}}):"tvoc"===n.type?r.a.createElement("img",{src:J.a,alt:"TVOC Icon",style:{position:"relative",display:"inline-block",maxHeight:"28px"}}):r.a.createElement("div",null),function(){var a=0,n=0,i=100;return e.state.HARMONY_WARN&&(a=2*e.state.HARMONY_WARN[t]),e.state.HARMONY_DANGER&&(n=10*e.state.HARMONY_DANGER[t]),n>100&&(a=0),i=i-a-n,r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"4px",maxWidth:"4px",flex:99}},r.a.createElement("div",{style:{flex:n,background:"#FF0000"}}),r.a.createElement("div",{style:{flex:a,background:"#fcba03"}}),r.a.createElement("div",{style:{flex:i,background:"#38c538"}}))}())}(),function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a],i="#FFF";if(n)return!n._mean&&0!==n._mean||!n._deviation&&0!==n._deviation||(i=n._mean+2*n._deviation<e.state.liveData[t]||n._mean-2*n._deviation>e.state.liveData[t]?"#FF0000":n._mean+n._deviation<e.state.liveData[t]||n._mean-n._deviation>e.state.liveData[t]?"#ded954":"#38c538"),r.a.createElement("div",{className:"Grow-Details-Main-Data-Current-Data",style:{background:i}},r.a.createElement("div",{style:{width:"1px",background:"#000"}}),function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a];if(n)return r.a.createElement("div",{style:{userSelect:"none",flex:1,display:"flex",justifyContent:"center"}},r.a.createElement("div",{style:{fontSize:"20px",userSelect:"none",display:"flex",fontWeight:700}},Math.round(10*e.state.liveData[t])/10),r.a.createElement("div",{style:{fontSize:"14px",userSelect:"none",display:"flex",fontWeight:600,marginTop:"2px"}},n.unit))}(),e.state.liveData[t]>e.state.lastLiveData[t]?r.a.createElement("div",{style:{fontSize:"11px",userSelect:"none",color:"#a02525",marginRight:"2px"}},r.a.createElement("span",{role:"img","aria-label":"higher value"},"\u25b2")):e.state.liveData[t]<e.state.lastLiveData[t]?r.a.createElement("div",{style:{fontSize:"11px",userSelect:"none",color:"#242490",marginRight:"2px"}},r.a.createElement("span",{role:"img","aria-label":"lower value"},"\u25bc")):r.a.createElement("div",null))}(),r.a.createElement("div",{className:"Grow-Details-Main-Data-Data",style:{marginBottom:"1px"}},r.a.createElement("div",{className:"Grow-Details-Main-Yest-Data",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",fontSize:"10px",userSelect:"none"}},function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a];if(n)return e.state.YEST_AVGS[a]?r.a.createElement("div",{style:{userSelect:"none",flex:1,display:"flex",justifyContent:"center"}},r.a.createElement("div",{style:{fontSize:"9px",userSelect:"none",display:"flex",fontWeight:"600"}},Math.round(10*e.state.YEST_AVGS[a])/10),r.a.createElement("div",{style:{fontSize:"9px",userSelect:"none",display:"flex",fontWeight:400}},n.unit)):void 0}(),function(){var a=e.state.SENSOR_PIDS.indexOf(t);if(e.state.DAILY_AVGS[a]&&e.state.YEST_AVGS[a])return e.state.DAILY_AVGS[a]>e.state.YEST_AVGS[a]?r.a.createElement("div",{style:{fontSize:"9px",color:"#FFF",userSelect:"none",marginRight:"2px"}},r.a.createElement("span",{role:"img","aria-label":"higher value"},"\u25b2")):e.state.DAILY_AVGS[a]<e.state.YEST_AVGS[a]?r.a.createElement("div",{style:{fontSize:"9px",color:"#FFF",userSelect:"none",marginRight:"2px"}},r.a.createElement("span",{role:"img","aria-label":"lower value"},"\u25bc")):r.a.createElement("div",null)}()),function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a];if(n)return e.state.DAILY_AVGS[a]?r.a.createElement("div",{style:{userSelect:"none",flex:1,display:"flex",justifyContent:"center",paddingBottom:"2px"}},r.a.createElement("div",{style:{fontSize:"16px",userSelect:"none",display:"flex",fontWeight:"600"}},Math.round(10*e.state.DAILY_AVGS[a])/10),r.a.createElement("div",{style:{fontSize:"11px",userSelect:"none",display:"flex",fontWeight:600,marginTop:"2px"}},n.unit)):void 0}()),r.a.createElement("div",{className:"Grow-Details-Main-Data-Data",style:{backgroundColor:"#c77725",marginBottom:"1px"}},r.a.createElement("div",{className:"Grow-Details-Main-Data-Time"},function(){var a=e.state.SENSOR_PIDS.indexOf(t);if(e.state.DAILY_HIGHS_TIMES){var n=P()(e.state.DAILY_HIGHS_TIMES[a]);return r.a.createElement("div",{style:{fontSize:"9px",userSelect:"none",textAlign:"right",fontWeight:"200",background:"#4b1a0a"}},n.format("HH:mm"))}}()),function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a];if(n)return e.state.DAILY_HIGHS?r.a.createElement("div",{style:{userSelect:"none",flex:1,display:"flex",justifyContent:"center"}},r.a.createElement("div",{style:{fontSize:"16px",userSelect:"none",display:"flex",fontWeight:"600",paddingBottom:"2px"}},Math.round(10*e.state.DAILY_HIGHS[a])/10),r.a.createElement("div",{style:{fontSize:"11px",userSelect:"none",display:"flex",fontWeight:600}},n.unit)):void 0}()),r.a.createElement("div",{className:"Grow-Details-Main-Data-Data",style:{backgroundColor:"#2584c7",marginBottom:"1px"}},r.a.createElement("div",{className:"Grow-Details-Main-Data-Time"},function(){var a=e.state.SENSOR_PIDS.indexOf(t);if(e.state.DAILY_LOWS_TIMES){var n=P()(e.state.DAILY_LOWS_TIMES[a]);return r.a.createElement("div",{style:{fontSize:"9px",userSelect:"none",textAlign:"right",fontWeight:"200",background:"#20314e"}},n.format("HH:mm"))}}()),function(){var a=e.state.SENSOR_PIDS.indexOf(t),n=e.props.grow.config.SENSORS[a];if(n)return e.state.DAILY_LOWS?r.a.createElement("div",{style:{userSelect:"none",flex:1,display:"flex",justifyContent:"center"}},r.a.createElement("div",{style:{fontSize:"16px",userSelect:"none",display:"flex",fontWeight:"600",paddingBottom:"2px"}},Math.round(10*e.state.DAILY_LOWS[a])/10),r.a.createElement("div",{style:{fontSize:"11px",userSelect:"none",display:"flex",fontWeight:600}},n.unit)):void 0}()))});return r.a.createElement("div",{className:"Grow-Details-Page-Panel"},r.a.createElement("div",{id:"Grow-Details-Data-Display"},function(){if(e.state.liveData)return r.a.createElement("div",{className:"Component-Grow-Data-Display"},r.a.createElement("div",{className:"Grow-Details-Headers-Display-Row"},function(){return e.props.activeLines?r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{color:"#FFF",fontSize:"12px",userSelect:"none",width:"120px",maxWidth:"120px",display:"flex",flexDirection:"row"}}):r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{color:"#FFF",fontSize:"12px",userSelect:"none",width:"120px",maxWidth:"120px",display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:(a={color:t,marginLeft:"1px"},Object(_.a)(a,"marginLeft","2px"),Object(_.a)(a,"marginRight","2px"),Object(_.a)(a,"marginTop","-1px"),a)},"\u2b24"),e.props.grow.name);var a}(),r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{width:"88px",maxWidth:"88px",userSelect:"none"}}),r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{width:"64px",maxWidth:"64px",userSelect:"none"}},"24h~"),r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{width:"64px",maxWidth:"64px",userSelect:"none"}},"24h\u2191"),r.a.createElement("div",{className:"Grow-Details-Main-Data-Row-Header",style:{width:"64px",maxWidth:"64px",userSelect:"none"}},"24h\u2193")),o)}()))}}]),t}(n.Component),U=a(139),Y=a.n(U),V=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getConfig=function(){var e=Object(S.a)(v.a.mark(function e(t){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.dbHelper.getGrowConfig(a.props.grow.id,t);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return","caught "+e.t0);case 9:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}(),a.setFetchedConfig=function(e){a.setState({config:e})},a.postConfig=function(){a.dbHelper.setGrowConfig(a.props.grow.id,a.state.config),a.props.refreshGrows(a.state.config),a.props.close()},a.sensorMeanChange=function(e){console.log("Change "+e.target.id+": "+e.target.value);var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t._mean=parseFloat(e.target.value))}),a.setState({config:t})},a.sensorDeviationChange=function(e){console.log("Change "+e.target.id+": "+e.target.value);var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t._deviation=parseFloat(e.target.value))}),a.setState({config:t})},a.sensorWeightChange=function(e){console.log("Change "+e.target.id+": "+e.target.value);var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t.thickness=e.target.value)}),a.setState({config:t})},a.sensorColorChange=function(e){var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t.color=e.target.value)}),a.setState({config:t})},a.sensorTypeChange=function(e){console.log("Change "+e.target.id+": "+e.target.value);var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t.type=e.target.value)}),a.setState({config:t})},a.sensorNameChange=function(e){console.log("Change "+e.target.id+": "+e.target.value);var t=a.state.config;t.SENSORS.forEach(function(t){t.PID===e.target.id&&(t.name=e.target.value)}),a.setState({config:t})},a.handleLightsOnChange=function(e){var t=a.state.config;t.LIGHTS.on=e,a.setState({config:t})},a.handleLightsOffChange=function(e){var t=a.state.config;t.LIGHTS.off=e,a.setState({config:t})},a.close=function(){a.props.close()},a.state={config:null},a.dbHelper=new E,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0,this.watchConfig=this.getConfig(this.setFetchedConfig)}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this,t=this.props.grow.config.SENSORS.map(function(t){return r.a.createElement("div",{key:t.PID,className:"Config-Settings-Field",style:{backgroundColor:"#3d7a80"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{userSelect:"none",fontsize:"0.6em",color:"#FFF",background:"#131B14",maxHeight:"30px",height:"30px"}},"airTemp"===t.type?r.a.createElement(H.d,{style:{fontSize:"1.3em",color:t.color}}):"waterTemp"===t.type?r.a.createElement(H.e,{style:{fontSize:"1.3em",color:t.color}}):"humidity"===t.type?r.a.createElement(H.b,{style:{fontSize:"1.3em",color:t.color}}):"fan"===t.type?r.a.createElement(H.c,{style:{fontSize:"1.3em",color:t.color}}):"humidifier"===t.type?r.a.createElement(H.a,{style:{fontSize:"1.3em",color:t.color}}):"co2"===t.type?r.a.createElement("img",{src:z.a,alt:"CO2 Icon",style:{position:"relative",display:"inline-block",maxHeight:"80%",color:t.color}}):"tvoc"===t.type?r.a.createElement("img",{src:J.a,alt:"CO2 Icon",style:{position:"relative",display:"inline-block",maxHeight:"80%",color:t.color}}):r.a.createElement("div",null),t.PID),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-evenly"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"Name"),r.a.createElement("div",{style:{fontWeight:"400"}},r.a.createElement("input",{onChange:e.sensorNameChange,id:t.PID,name:"name",type:"name",defaultValue:t.name,maxLength:"16",style:{fontSize:"0.8em",maxWidth:"70px"}}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"Type"),r.a.createElement("div",null,r.a.createElement("select",{onChange:e.sensorTypeChange,id:t.PID,defaultValue:t.type,style:{fontSize:"0.8em",maxWidth:"74px",height:"20px"}},r.a.createElement("option",{value:"airTemp"},"airTemp"),r.a.createElement("option",{value:"waterTemp"},"waterTemp"),r.a.createElement("option",{value:"humidity"},"humidity"),r.a.createElement("option",{value:"co2"},"CO\u2082"),r.a.createElement("option",{value:"fan"},"fan"),r.a.createElement("option",{value:"humidifier"},"humidifier")))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"Weight"),r.a.createElement("div",null,r.a.createElement("select",{onChange:e.sensorWeightChange,id:t.PID,defaultValue:t.thickness,style:{fontSize:"0.7em",maxWidth:"44px",height:"20px"}},r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"1.5"},"1.5"),r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"0.75"},"0.75"),r.a.createElement("option",{value:"0.5"},"0.5"),r.a.createElement("option",{value:"0.25"},"0.25")))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"Mean"),r.a.createElement("div",{style:{fontSize:"1em",fontWeight:"400"}},r.a.createElement("input",{type:"number",onChange:e.sensorMeanChange,id:t.PID,name:"_mean",defaultValue:t._mean,style:{fontSize:"0.8em",maxWidth:"36px"}}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"SDev"),r.a.createElement("div",{style:{fontSize:"1em",fontWeight:"400"}},r.a.createElement("input",{type:"number",onChange:e.sensorDeviationChange,id:t.PID,name:"_deviation",defaultValue:t._deviation,style:{fontSize:"0.8em",maxWidth:"36px"}}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{fontSize:"0.7em",userSelect:"none"}},"Color"),r.a.createElement("div",{style:{fontSize:"1em",fontWeight:"400"}},r.a.createElement("input",{onChange:e.sensorColorChange,id:t.PID,name:"color",type:"color",defaultValue:t.color,maxLength:"10",style:{fontSize:"0.8em",padding:0,marginTop:"1px",maxWidth:"18px",maxHeight:"18px"}}))))))});return r.a.createElement("div",{style:{height:"100%",maxHeight:"100%",width:"100%",maxWidth:"100%",backgroundColor:"#000000BF",position:"fixed",justifyItems:"center",justifyContent:"center",alignContent:"center",zIndex:3}},r.a.createElement("div",{style:{margin:"auto",width:"90%",height:"90%",border:"3px solid #262626",padding:"10px",background:"#303630",color:"#d3dbd5"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},r.a.createElement("div",{style:{fontSize:"1.2em",userSelect:"none"}}),r.a.createElement("div",{style:{fontSize:"1em",fontWeight:"100",userSelect:"none"}},"Settings"),r.a.createElement("div",{onClick:this.close,style:{fontSize:"1.2em",color:"#FF0000",userSelect:"none",cursor:"pointer"}},"X")),function(){if(e.state.config)return r.a.createElement("div",{id:"Grow-Details-Config-Settings-Div",style:{margin:"4px",height:"95%"}},r.a.createElement("div",{id:"Grow-Details-Config-Scroll",style:{overflowY:"scroll"}},function(){if(e.state.config.LIGHTS)return r.a.createElement("div",null,r.a.createElement("div",{className:"Config-Item-Header-Text"},"LIGHTS"),r.a.createElement("div",{className:"Config-Settings-Field",style:{backgroundColor:"#e8e81e"}},r.a.createElement("div",{className:"Settings-Data-Line"},r.a.createElement("div",null,"on ",r.a.createElement(Y.a,{clearIcon:null,id:"lights_on",value:e.state.config.LIGHTS.on,onChange:e.handleLightsOnChange.bind(e)})),r.a.createElement("div",null,"off ",r.a.createElement(Y.a,{clearIcon:null,id:"lights_off",value:e.state.config.LIGHTS.off,onChange:e.handleLightsOffChange.bind(e)})))))}(),r.a.createElement("div",{className:"Config-Item-Header-Text"},"SENSORS"),t,r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"4px"}},r.a.createElement("div",{id:"GROW-DETAILS-SAVE-CONFIG-BTN",onClick:function(){return e.postConfig()}},"SAVE ",r.a.createElement("br",null)," SETTINGS"))))}()),void 0)}}]),t}(n.Component),K=a(210),$=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentWillUnmount=function(){a._ismounted=!1},a.componentDidUpdate=function(){if(a.props.rawGrowData){if(!a.props.rawGrowData[a.props.grow.id])return;var e=a.props.rawGrowData[a.props.grow.id][a.props.rawGrowData[a.props.grow.id].length-1].length;a.dataLengthRef!==e?(a.dataLengthRef=e,a.initializeGrowPage()):a.state.TABLE_INIT||(a.dataLengthRef=e,a.initializeGrowPage(),a.setState({TABLE_INIT:!0}))}},a.initializeGrowPage=function(){var e=[];a.state.SENSORS_INIT!==a.props.grow&&a.props.grow.config.SENSORS!==a.state.SENSOR_PIDS&&(a.props.grow.config.SENSORS.forEach(function(t,a){e[a]!==t.PID&&(e[a]=t.PID)}),a.setState({SENSOR_PIDS:e}),a.state.ACTIVE_INIT!==a.props.grow&&a.setState({ACTIVE_LINES:e,ACTIVE_INIT:a.props.grow}))},a.toggleLine=function(e){var t=e.split("^")[0],n=a.state.SENSOR_PIDS.indexOf(t),r=a.state.ACTIVE_LINES;r.includes(t)?r[n]=null:r[n]=t,a.setState({ACTIVE_LINES:r}),a.forceUpdate()},a.openCloseSettings=function(){a.state.SHOW_SETTINGS?a.setState({SHOW_SETTINGS:!1}):a.setState({SHOW_SETTINGS:!0})},a.state={SENSOR_PIDS:[],SENSORS_INIT:!1,ACTIVE_LINES:[],ACTIVE_INIT:!1,TABLE_INIT:!1,SHOW_SETTINGS:!1},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this._ismounted=!0,this.props.rawGrowData&&this.state.SENSOR_PIDS&&this.state.SENSOR_MEANS){if(!this.props.rawGrowData[this.props.grow.id])return;var e=this.props.rawGrowData[this.props.grow.id][this.props.rawGrowData[this.props.grow.id].length-1].length;this.dataLengthRef!==e&&(this.dataLengthRef=e,this.initializeGrowPage()),this.forceUpdate()}}},{key:"render",value:function(){var e=this,t="#FFF";if(this.props.liveGrowData&&this.props.liveGrowData[this.props.grow.id]){var a=(new Date).getTime(),n=new Date(1e3*this.props.liveGrowData[this.props.grow.id].time);this.updatedAtDate&&n!==this.updatedAtDate[this.props.grow.id]&&(this.updatedAtDate[this.props.grow.id]=n);var i=a-1e3*this.props.liveGrowData[this.props.grow.id].time;i>1e7?t="#989e98":i>3e5?t="#fa360a":i>6e4?t="#facb23":i<6e4&&(t="#27d927"),P()(n).fromNow()}return r.a.createElement("div",{className:"Grow-Details-Page"},r.a.createElement("div",{className:"Grow-Details-Page-Content"},r.a.createElement("div",{className:"Grow-Details-Content-Bottom"},r.a.createElement("div",{className:"Grow-Details-Header"},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1}},r.a.createElement("div",{style:{color:t,marginLeft:"1px",fontSize:"1.1em"}},"\u2b24"),r.a.createElement("div",{id:"Grow-Header-Text"},this.props.grow.name)),r.a.createElement("div",{onClick:function(){return e.openCloseSettings()},style:{paddingRight:"30px",color:"#A9A9A9",userSelect:"none",cursor:"pointer"}},r.a.createElement(K.a,{style:{color:"#9e9e9e",fontSize:"22px",marginTop:"8px"}}))),r.a.createElement("div",{className:"Grow-Details-Bottom-Item"},r.a.createElement(L,{activeLines:this.state.ACTIVE_LINES,rawGrowData:this.props.rawGrowData,grow:this.props.grow}))),function(){if(e.state.SHOW_SETTINGS)return r.a.createElement(V,{grow:e.props.grow,refreshGrows:e.props.refreshGrows,close:e.openCloseSettings})}(),r.a.createElement("div",{className:"Grow-Details-Page-Panel"},r.a.createElement("div",{id:"Grow-Details-Data-Display"},r.a.createElement(B,{grow:this.props.grow,toggleLine:this.toggleLine,threeDayData:this.props.rawGrowData,liveGrowData:this.props.liveGrowData,user:this.props.user,activeLines:this.state.ACTIVE_LINES})))))}}]),t}(n.Component),Z=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidUpdate=function(){a._ismounted},a.closeModal=function(e){a.setState({displayContent:"main"})},a.openMainPage=function(e,t){a.props.openMainPage(e,t)},a.openCreateGrowModal=function(){alert("GrowPage.js openCreateGrowModal() TODO")},a.openGrow=function(e){e||a.props.setGrow(null),a.props.setGrow(e)},a.setJournalID=function(e){console.log("setJournalID: "+e),a.props.setJournalID(e)},a.state={displayContent:"main",grow:a.props.grow},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"Grow-Page"},r.a.createElement("div",{id:"Grow-Main"},r.a.createElement("div",{id:"Grow-Main-Area"},function(){if(null===e.props.grow)return r.a.createElement("div",{style:{height:"100%"}})}(),function(){if(e.props.grow)return r.a.createElement($,{grow:e.props.grow,refreshGrows:e.props.refreshGrows,openMainPage:e.openMainPage,setJournalID:e.setJournalID,rawGrowData:e.props.rawGrowData,liveGrowData:e.props.liveGrowData,user:e.props.user,userGrows:e.props.userGrows})}())))}}]),t}(n.Component),X=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidUpdate=function(){if(a.props.rawGrowData&&a.props.growIDs){var e=[],t=!1;a.props.growIDs.forEach(function(n){if(a.props.rawGrowData[n])if(a.DataLengthChecks&&a.DataLengthChecks[n]&&a.props.rawGrowData[n]&&a.DataLengthChecks[n]===a.props.rawGrowData[n][a.props.rawGrowData[n].length-1].length)e[n]=a.props.rawGrowData[n][a.props.rawGrowData[n].length-1].length;else{t=!0,e[n]=a.props.rawGrowData[n][a.props.rawGrowData[n].length-1].length;var r=[];a.props.rawGrowData[n].forEach(function(e){r=r.concat(e)}),a.DataLengthChecks&&a.DataLengthChecks[n]===r.length||(r.sort(function(e,t){return e.time>t.time?1:-1}),a.concatData[n]=r)}else e[n]=0}),t&&(a.DataLengthChecks=e,a.processData())}},a.processData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.displayWindow,t=null;if(a.concatData){t=a.concatData;var n=(new Date).getTime(),r=[],i=[];a.props.growIDs.forEach(function(o){if(t[o]){var s=[],l=-1;t[o].forEach(function(t){var r={},c=Math.round(a.state.displayWindow/108e5);if(c<1&&(c=1),n-t.time<e&&(0===++l||l%c===0)){for(var u=t,p=0,d=Object.entries(u);p<d.length;p++){var h=d[p],m=Object(F.a)(h,2),f=m[0],g=m[1];"time"!==f?r[f+"^"+o]=g:r.time=g}i[i.length]=r,s[s.length]=u}}),r[o]=s}}),i.sort(function(e,t){return e.time>t.time?1:-1}),a.setState({combinedProcessedData:i,processedData:r})}},a.toggleWindow=function(e){a.setState({displayWindow:e.target.value}),a.processData(e.target.value),a.props.toggleWindow(e.target.value)},a.renderTooltip=function(e){var t=e.payload;if(null!==t&&0!==t.length){var n=P()(e.payload[0].payload.time).format("ddd - HH:mm"),i=t.map(function(e){var t=e.name.split("^")[1],n=e.name.split("^")[3];if(!(a.props.user&&a.props.user.PREFS&&a.props.user.PREFS.GRAPHS&&a.props.user.PREFS.GRAPHS.AllGraph&&a.props.user.PREFS.GRAPHS.AllGraph.showSensors&&!1===a.props.user.PREFS.GRAPHS.AllGraph.showSensors[e.dataKey])){var i=null;a.props.userGrows.forEach(function(e){return e.id===t?void(i=e):void 0});var o=null;return i.config.SENSORS.forEach(function(e){e.PID===n&&(o=e)}),r.a.createElement("div",{className:"AllGraph-Tooltip-Data",key:e.dataKey,style:{color:o.color,paddingLeft:"2px",paddingRight:"2px"}},r.a.createElement("div",{style:{color:o.color,display:"flex",flexDirection:"row",justifyContent:"space-between"}},r.a.createElement("div",null,o.name,": "),r.a.createElement("div",{style:{fontWeight:800}},e.payload[e.dataKey]," ",o.unit)),r.a.createElement("div",{style:{width:"100%",height:"1px",background:"#2d2d2e"}}))}});return r.a.createElement("div",{className:"AllGraph-Tooltip"},r.a.createElement("div",null,n),i)}},a.state={displayWindow:432e5,lightsOnArray:[],lightsOffArray:[],tickArray:[],lightBackgrounds:["#7344e740","#fff93640"]},a.concatData=[],a.firstPointTime=0,a.lastPointTime=0,a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this._ismounted=!0,this.props.user&&this.props.user.PREFS&&this.props.user.PREFS.GRAPHS&&this.props.user.PREFS.GRAPHS.AllGraph&&this.props.user.PREFS.GRAPHS.AllGraph.timeWindow&&this.props.user.PREFS.GRAPHS.AllGraph.timeWindow!==this.state.displayWindow&&this.setState({displayWindow:this.props.user.PREFS.GRAPHS.AllGraph.timeWindow}),this.props.rawGrowData&&this.props.growIDs){var t=[],a=!1;this.props.growIDs.forEach(function(n){if(e.props.rawGrowData[n])if(e.DataLengthChecks&&e.DataLengthChecks[n]&&e.props.rawGrowData[n]&&e.DataLengthChecks[n]===e.props.rawGrowData[n][e.props.rawGrowData[n].length-1].length)t[n]=e.props.rawGrowData[n][e.props.rawGrowData[n].length-1].length;else{a=!0,t[n]=e.props.rawGrowData[n][e.props.rawGrowData[n].length-1].length;var r=[];e.props.rawGrowData[n].forEach(function(e){r=r.concat(e)}),e.DataLengthChecks&&e.DataLengthChecks[n]===r.length||(r.sort(function(e,t){return e.time>t.time?1:-1}),e.concatData[n]=r)}else t[n]=0}),a&&(this.DataLengthChecks=t,this.processData())}}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=this,t=432e5;if(this.props.user&&this.props.user.PREFS&&this.props.user.PREFS.GRAPHS&&this.props.user.PREFS.GRAPHS.AllGraph&&this.props.user.PREFS.GRAPHS.AllGraph.timeWindow&&(t=this.props.user.PREFS.GRAPHS.AllGraph.timeWindow),this.state.combinedProcessedData){var a=this.props.userGrows.map(function(t){return t.config.SENSORS.map(function(a){var n=a.name+"^"+t.id+"^"+a.unit+"^"+a.PID,i=a.PID+"^"+t.id;if(!(e.props.user&&e.props.user.PREFS&&e.props.user.PREFS.GRAPHS&&e.props.user.PREFS.GRAPHS.AllGraph&&e.props.user.PREFS.GRAPHS.AllGraph.showSensors&&!1===e.props.user.PREFS.GRAPHS.AllGraph.showSensors[i]))return"airTemp"===a.type||"waterTemp"===a.type?r.a.createElement(N.b,{yAxisId:"temperature",connectNulls:!0,type:"monotone",name:n,dataKey:i,key:i,stroke:a.color,strokeWidth:a.thickness,dot:!1}):"humidifier"===a.type||"fan"===a.type||"humidity"===a.type?r.a.createElement(N.b,{yAxisId:"percent",connectNulls:!0,type:"monotone",name:n,dataKey:i,key:i,stroke:a.color,strokeWidth:a.thickness,dot:!1}):"\u1d56\u1d56\u1d50"===a.unit?r.a.createElement(N.b,{yAxisId:"ppm",connectNulls:!0,type:"monotone",name:n,dataKey:i,key:i,stroke:a.color,strokeWidth:a.thickness,dot:!1}):"\u1d56\u1d56\u1d47"===a.unit?r.a.createElement(N.b,{yAxisId:"ppb",connectNulls:!0,type:"monotone",name:n,dataKey:i,key:i,stroke:a.color,strokeWidth:a.thickness,dot:!1}):r.a.createElement(N.b,{yAxisId:"ppm",connectNulls:!0,type:"monotone",name:n,dataKey:i,key:i,stroke:a.color,strokeWidth:a.thickness,dot:!1})})}),n=null;if(this.props.parentSize){var i=Math.floor(.9*this.props.parentSize[0]),o=Math.floor(.9*this.props.parentSize[1]);n=r.a.createElement(N.c,{width:i,height:o,data:this.state.combinedProcessedData},a,r.a.createElement(N.a,{vertical:!0,horizontal:!1,verticalFill:[this.state.lightBackgrounds[0],this.state.lightBackgrounds[1]],stroke:"none",fillOpacity:.2}),r.a.createElement(N.e,{tick:{fill:"#B3C2B5"},dataKey:"time",type:"number",domain:[(new Date).getTime(),new Date(new Date-this.state.displayWindow).getTime()],ticks:this.state.tickArray,tickFormatter:function(e){return P()(1*e).format("ddd - HH:mm")}}),r.a.createElement(N.f,{yAxisId:"temperature",orientation:"left",domain:[24],tick:{fill:"#B3C2B5"}}),r.a.createElement(N.f,{yAxisId:"percent",orientation:"right",hide:!0,domain:[0,100],tick:{fill:"#B3C2B5"}}),r.a.createElement(N.f,{yAxisId:"ppm",orientation:"right",hide:!0,domain:[0,100],tick:{fill:"#false"}}),r.a.createElement(N.f,{yAxisId:"ppb",orientation:"right",hide:!0,domain:[0,100],tick:{fill:"false"}}),r.a.createElement(N.d,{content:this.renderTooltip}))}}return r.a.createElement("div",{className:"Chart-Container",style:{background:"#000"}},n,r.a.createElement("div",{style:{width:"40px",fontSize:"0.55em",display:"flex",flexDirection:"column",position:"absolute",marginLeft:"36px",marginTop:"18px"}},r.a.createElement("select",{onChange:this.toggleWindow,id:"AllGraph-Time-Scale",defaultValue:t,style:{fontSize:"0.8em",maxWidth:"74px",height:"20px"}},r.a.createElement("option",{value:18e5},"\xbdh"),r.a.createElement("option",{value:108e5},"3h"),r.a.createElement("option",{value:432e5},"12h"),r.a.createElement("option",{value:864e5},"24h"),r.a.createElement("option",{value:2592e5},"72h"))))}}]),t}(n.Component),Q=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){if(a._ismounted=!0,a.props.user&&a.setState({user:a.props.user,activeLines:a.props.user.PREFS.GRAPHS.AllGraph.showSensors}),a.props.userGrows&&a.props.user){if(a.props.userGrows===a.userGrows)return;a.userGrows=a.props.userGrows;for(var e=[],t=0,n=Object.entries(a.props.userGrows);t<n.length;t++){var r=n[t],i=Object(F.a)(r,1)[0],o=a.props.userGrows[i],s=[];a.props.userGrows[i].config.SENSORS.forEach(function(e,t){if(s[t]!==e.PID){var n=e.PID+"^"+o.id;if(a.props.user.PREFS&&a.props.user.PREFS.GRAPHS&&a.props.user.PREFS.GRAPHS.AllGraph&&a.props.user.PREFS.GRAPHS.AllGraph.showSensors&&!1===a.props.user.PREFS.GRAPHS.AllGraph.showSensors[n])return;s[s.length]=n}}),e[o.id]=s}a.setState({groupedSensors:e})}a.calcGraphDimensions()},a.componentWillUnmount=function(){a._ismounted=!1},a.toggleLine=function(e){var t=a.props.user;if(t.PREFS&&t.PREFS.GRAPHS&&t.PREFS.GRAPHS.AllGraph&&t.PREFS.GRAPHS.AllGraph.showSensors&&!1===t.PREFS.GRAPHS.AllGraph.showSensors[e])return t.PREFS.GRAPHS.AllGraph.showSensors[e]=!0,a.setUserPrefs(t),void a.setState({user:t});t.PREFS.GRAPHS.AllGraph.showSensors[e]=!1,a.setUserPrefs(t),a.setState({user:t})},a.toggleWindow=function(e){var t=a.props.user;t.PREFS.GRAPHS.AllGraph.timeWindow=e,a.setUserPrefs(t)},a.setUserPrefs=function(e){a.props.setFirebaseUser(e)},a.state={grow:a.props.grow,graphElementSize:[150,150],graphSizeUpdated:0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){if(this.calcGraphDimensions(),this.state.growIDs){if(this.state.growIDs.length===this.props.userGrows.length)return}else;if(this.props.userGrows&&(!this.state.growIDs||this.state.growIDs&&this.state.growIDs.length!==this.props.userGrows.length)){var e=this.state.growIDs;e||(e=[]);for(var t=0,a=Object.entries(this.props.userGrows);t<a.length;t++){var n=a[t],r=Object(F.a)(n,1)[0];e&&e.includes(this.props.userGrows[r].id)||(e[e.length]=this.props.userGrows[r].id)}this.setState({growIDs:e})}}},{key:"calcGraphDimensions",value:function(){var e=new Date;if(this.state.graphElementSize!==[this.divRef.clientWidth,this.divRef.clientHeight]&&e.getTime()-this.state.graphSizeUpdated>500){var t=[this.divRef.clientWidth+this.divRef.clientWidth/100*12,this.divRef.clientHeight+this.divRef.clientHeight/100*14];t!==this.state.graphElementSize&&this._ismounted&&this.setState({graphElementSize:t,graphSizeUpdated:e.getTime()})}}},{key:"render",value:function(){var e=this,t=[];return this.state.growIDs&&this.props.userGrows&&(t=this.props.userGrows.map(function(t){return r.a.createElement(B,{grow:t,toggleLine:e.toggleLine,threeDayData:e.props.threeDayData,liveGrowData:e.props.liveGrowData,user:e.state.user})})),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden"}},r.a.createElement("div",{style:{width:"100vw",height:"60vh",minHeight:"60vh"},ref:function(t){return e.divRef=t}},function(){if(e.state.growIDs&&e.state.graphElementSize&&e.state.groupedSensors)return r.a.createElement(X,{parentSize:e.state.graphElementSize,rawGrowData:e.props.threeDayData,groupedSensors:e.state.groupedSensors,userGrows:e.props.userGrows,growIDs:e.state.growIDs,toggleWindow:e.toggleWindow,user:e.state.user})}()),r.a.createElement("div",{className:"Grow-Details-Page-Panel",style:{zIndex:99}},r.a.createElement("div",{id:"Grow-Details-Data-Display"},r.a.createElement("div",{id:"All-Graphs-Buttons"},t))))}}]),t}(n.Component),q=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidUpdate=function(){a.props.normalizedData&&a.props.normalizedData!==a.state.normalizedData&&(console.log("NORMALIZED DATA",a.props.normalizedData),a.setState({normalizedData:a.props.normalizedData}))},a.renderTooltip=function(e){var t=e.payload;if(null!==t&&0!==t.length){var a=P()(e.payload[0].payload.time).format("MM-D-YYYY"),n=t.map(function(e){return r.a.createElement("div",{style:{fontSize:".6em",color:e.stroke},key:e.dataKey},e.dataKey.split("^")[0]," ",e.dataKey.split("^")[2]," : ",t[0].payload[e.dataKey])});return r.a.createElement("div",{className:"Lifetime-Graph-Tooltip"},r.a.createElement("div",null,a),n)}},a.state={},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this._ismounted=!0,this.props.grow&&this._ismounted&&this.props.grow.id!==this.growID&&(this.growID=this.props.grow.id)}},{key:"componentWillUnmount",value:function(){this._ismounted=!1}},{key:"render",value:function(){var e=null;if(this.props.sensorList){e=this.props.sensorList.map(function(e){return 0,"HIGH"===e.split("^")[2]?r.a.createElement(N.b,{yAxisId:"left",type:"monotone",name:e,dataKey:e,key:e,stroke:"#FF0000",thickness:.5,dot:!1}):"LOW"===e.split("^")[2]?r.a.createElement(N.b,{yAxisId:"left",type:"monotone",name:e,dataKey:e,key:e,stroke:"#19b2ff",thickness:.5,dot:!1}):r.a.createElement(N.b,{yAxisId:"left",type:"monotone",name:e,dataKey:e,key:e,stroke:"#FFFFFF",thickness:1,dot:!1})})}var t=null;if(this.state.normalizedData&&this.state.normalizedData[0]&&this.props.parentSize){var a=Math.floor(1*this.props.parentSize[0]),n=Math.floor(.9*this.props.parentSize[1]);t=r.a.createElement(N.c,{width:a,height:n,data:this.state.normalizedData},e,r.a.createElement(N.e,{dataKey:"time",type:"number",domain:[new Date(this.state.normalizedData[0].time).getTime(),new Date(this.state.normalizedData[this.state.normalizedData.length-1].time).getTime()],tickFormatter:function(e){return P()(e).format("MM-D-YYYY")},hide:!1}),r.a.createElement(N.f,{yAxisId:"left",orientation:"left",domain:[21,27]}),r.a.createElement(N.f,{yAxisId:"right",orientation:"right"}),r.a.createElement(N.d,{content:this.renderTooltip}))}return r.a.createElement("div",{className:"Chart-Container-Box"},t)}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).componentDidMount=function(){a._ismounted=!0,a.props.lifetimeData&&a.normalizeLifetimeData(a.props.lifetimeData),a.calcGraphDimensions()},a.componentWillUnmount=function(){a._ismounted=!1},a.setStateMonthChunk=function(e){a.setState({monthChunk:e}),a.processChunk(e)},a.state={graphElementSize:[150,150],graphSizeUpdated:0,growID:"-C02kOvSXRrm1zIZ6EOx",year:"2020",month:"09"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){this.calcGraphDimensions()}},{key:"calcGraphDimensions",value:function(){var e=new Date;if(this.state.graphElementSize!==[this.divRef.clientWidth,this.divRef.clientHeight]&&e.getTime()-this.state.graphSizeUpdated>500){var t=[this.divRef.clientWidth,this.divRef.clientHeight+this.divRef.clientHeight/100*5];t!==this.state.graphElementSize&&this._ismounted&&this.setState({graphElementSize:t,graphSizeUpdated:e.getTime()})}}},{key:"postLifetimeData",value:function(e,t){this.props.postLifetimeData(e,this.state.growID,this.state.year,this.state.month,t)}},{key:"normalizeLifetimeData",value:function(){var e=this;console.log("normalize LIFETIMEDATA!",this.props.lifetimeData);this.props.lifetimeData;var t=["01","02","03","04","05","06","07","08","09","10","11","12"],a=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],n=[],r=[];[2019,2020].forEach(function(i){t.forEach(function(t){a.forEach(function(a){for(var o={},s=0,l=Object.entries(e.props.lifetimeData);s<l.length;s++){var c=l[s],u=Object(F.a)(c,2),p=u[0],d=u[1];if(d[i]&&d[i][t]&&d[i][t][a])for(var h=0,m=Object.entries(d[i][t][a]);h<m.length;h++)for(var f=m[h],g=Object(F.a)(f,2),v=g[0],S=g[1],E=0,D=Object.entries(S);E<D.length;E++){var w=D[E],y=Object(F.a)(w,2),I=y[0],b=y[1],G=I+"^"+p+"^"+v;o[G]=b,r.includes(G)||(r[r.length]=G)}}if(0!==Object.keys(o).length){var O=new Date(i+"-"+t+"-"+a).valueOf();o.time=O,n[n.length]=o}})})}),this.setState({sensorList:r,normalizedData:n})}},{key:"getMonthChunkData",value:function(){this.props.getMonthChunkData(this.state.growID,this.state.year,this.state.month,this.setStateMonthChunk)}},{key:"processChunk",value:function(e){console.log("chunky0PRIME ",e);for(var t=0,a=Object.entries(e);t<a.length;t++){for(var n=a[t],r=Object(F.a)(n,2),i=r[0],o=r[1],s=[],l=[],c=[],u=[],p=0,d=Object.entries(o);p<d.length;p++)for(var h=d[p],m=Object(F.a)(h,2),f=(m[0],m[1]),g=0,v=Object.entries(f);g<v.length;g++)for(var S=v[g],E=Object(F.a)(S,2),D=(E[0],E[1]),w=0,y=Object.entries(D);w<y.length;w++){var I=y[w],b=Object(F.a)(I,2),G=b[0],O=b[1];"time"!==G&&(s[G]?s[G]=s[G]+1:s[G]=1,l[G]?l[G]=parseFloat(l[G])+parseFloat(O):l[G]=Math.round(10*O)/10,(!u[G]||u[G]<O)&&(u[G]=Math.round(10*O)/10),(!c[G]||c[G]>O)&&(c[G]=Math.round(10*O)/10))}for(var x=0,k=Object.entries(l);x<k.length;x++){var C=k[x],A=Object(F.a)(C,2),j=A[0],N=A[1];l[j]=Math.round(N/s[j]*10)/10}var R=[];R.HIGH=u,R.LOW=c,R.AVERAGE=l,this.postLifetimeData(R,i)}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{width:"100vw",minHeight:"65vh"},ref:function(t){return e.divRef=t}},r.a.createElement("div",{className:"AllGraphs-Graph-Item"},r.a.createElement("div",{className:"AllGraphs-Graph-Main"},r.a.createElement("div",{className:"AllGraphs-Info"},r.a.createElement("div",{className:"Lifetime-Graph-Area"},r.a.createElement(q,{parentSize:this.state.graphElementSize,normalizedData:this.state.normalizedData,sensorList:this.state.sensorList})))))),r.a.createElement("div",{className:"Grow-Details-Page-Panel"}))}}]),t}(n.Component),te=a(211),ae=a.n(te),ne=a(212),re=a(213),ie=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).openJournals=function(){a.props.setMainContent("journals")},a.openGraphs=function(){a.props.setMainContent("graphs")},a.openLifetime=function(){a.props.setMainContent("lifetime")},a.openGrows=function(){a.props.setMainContent("grows")},a.setGrow=function(e){a.props.userGrows.forEach(function(t){t.id===e.target.dataset.value&&a.props.setGrow(t)})},a.handleSignOut=function(){a.props.handleSignOut()},a.state={},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=null;return this.props.userGrows&&(t=this.props.userGrows.map(function(t){var a=null;e.props.liveGrowData[t.id]&&(a=e.props.liveGrowData[t.id]);var n=t.name.split(" "),i="";t.name.length>=4?n.forEach(function(e){i+=e.charAt(0)}):i=t.name;var o="#FF0000";if(e.props.liveGrowData[t.id]){var s=(new Date).getTime(),l=new Date(1e3*e.props.liveGrowData[t.id].time);e.updatedAtDate&&l!==e.updatedAtDate[t.id]&&(e.updatedAtDate[t.id]=l);var c=s-1e3*e.props.liveGrowData[t.id].time;c>1e7?o="#989e98":c>3e5?o="#fa360a":c>6e4?o="#facb23":c<6e4&&(o="#27d927"),P()(l).fromNow()}return r.a.createElement("div",{className:"App-Bar-Button-Grow",key:t.id,onClick:e.setGrow,"data-value":t.id},r.a.createElement("div",{className:"App-Bar-Button-Updated","data-value":t.id},r.a.createElement("div",{style:{color:o,marginLeft:"1px",fontSize:"10px"}},"\u2b24")),r.a.createElement("div",{className:"App-Bar-Button-Grow-Name","data-value":t.id},i),function(){if(a&&a.sA1_Temp)return r.a.createElement("div",{ref:e.flowerTempRef,className:"App-Bar-Button-Grow-Temp","data-value":t.id},Math.round(10*a.sA1_Temp)/10,"\xb0C")}(),function(){if(a&&a.sA1_Humi)return r.a.createElement("div",{ref:e.flowerHumidityRef,className:"App-Bar-Button-Grow-Humidity","data-value":t.id},Math.round(10*a.sA1_Humi)/10,"%")}())})),r.a.createElement("div",{id:"App-Bar"},r.a.createElement("div",{id:"App-Bar-Logo",onClick:this.openGraphs},r.a.createElement("img",{src:ae.a,alt:"App Logo",style:{maxWidth:"100px"}})),t,r.a.createElement("div",{className:"App-Bar-Button-Grow",style:{background:"#6b5729"},onClick:this.openLifetime},r.a.createElement(ne.a,{style:{color:"#FFF",fontSize:"30px",paddingTop:"5px"}})," L"),r.a.createElement("div",{className:"App-Bar-Button-Grow",style:{background:"#a0823e"},onClick:this.openJournals},r.a.createElement(re.a,{style:{color:"#FFF",fontSize:"30px",paddingTop:"5px"}})),r.a.createElement("div",{className:"App-Bar-Filler-Div"}),r.a.createElement("div",{className:"App-Bar-Logout-Button",onClick:this.handleSignOut},"\u27b2"))}}]),t}(n.Component),oe=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).setUser=function(e){a.setState({user:e})},a.setFirebaseUserPrefs=function(e){a.setState({user:e}),console.log("temp user GONNASET",e),a.dbHelper.setUser(e)},a.postLifetimeData=function(e,t,n,r,i){console.log("chunky post LifetimeData",e),a.dbHelper.postLifetimeData(e,t,n,r,i)},a.stateSetLifetimeData=function(e){a.setState({lifetimeData:e})},a.getMonthChunkData=function(e,t,n,r){a.dbHelper.getMonthChunk(e,t,n,r)},a.refreshGrows=function(e){var t=a.state.currentGrow;t.config=e,a.setState({currentGrow:t})},a.setUserGrows=function(e){console.log("USER GROWS!",e),e.forEach(function(e){a.dbHelper.getThreeDayData(e.id,a.setThreeDayData)}),a.setState({userGrows:e}),a.dbHelper.getLiveGrowData(e,a.setLiveGrowData)},a.setUserJournals=function(e){a.setState({userJournals:e})},a.setLiveGrowData=function(e,t){if(null!==t){var n=a.state.liveGrowData;n[e.toString()]=t,a.setState({liveGrowData:n})}},a.setThreeDayData=function(e,t,n){var r=a.state.threeDayData,i=[];t=parseInt(t),r[e]&&(i=r[e]),i[t]&&(i[t]=null),i[t]=n,r[e]=i,a.setState({threeDayData:r})},a.getUsername=function(){a.firebase.db.ref().child("users").child(a.state.UID).on("value",function(e){a.setState({username:e.val().username})},function(e){console.log("The username read failed: "+e.code)})},a.handleSignOut=function(){a.setState({UID:null}),a.firebase.auth.signOut().then(function(){console.log("signed out"),window.location.reload()}).catch(function(e){console.log("Error signing out: ".concat(e))})},a.setMainContent=function(e,t){a.setState({mainContent:e,currentGrow:null,growID:t,journalID:null})},a.openJournals=function(){"journals"!==a.state.mainContent?a.setState({mainContent:"journals",journalID:null}):a.setState({journalID:null})},a.openGrows=function(){"grows"!==a.state.mainContent?a.setState({mainContent:"grows",currentGrow:null}):a.setState({currentGrow:null})},a.setGrow=function(e){console.log("APP Setgrow",e),a.setState({currentGrow:e,mainContent:"grows"})},a.setJournalID=function(e){console.log("APP SetJournalID",e),a.setState({mainContent:"journals",journalID:e})},a.state={mainContent:"signin",UID:null,username:"",journalID:null,currentGrow:null,growID:null,userJournals:[],liveGrowData:[],threeDayData:[]},a.dbHelper=new E,a.firebase=new f,a.firebase.auth.onAuthStateChanged(function(e){e&&(a.setState({UID:e.uid}),a.getUsername(),a.dbHelper.getLifetimeData(e.uid,a.stateSetLifetimeData),a.dbHelper.getUser(e.uid,a.setUser),a.dbHelper.getUserGrows(a.setUserGrows),a.dbHelper.getUserJournals(a.setUserJournals))}),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-body"},function(){if(e.state.UID)return r.a.createElement(ie,{mainContent:e.state.mainContent,setMainContent:e.setMainContent,setGrow:e.setGrow,handleSignOut:e.handleSignOut,liveGrowData:e.state.liveGrowData,userGrows:e.state.userGrows})}(),r.a.createElement("div",{id:"App-Inner-Body"},r.a.createElement("div",{id:"App-Body-Content"},function(){if(e.state.UID&&e.state.userGrows&&e.state.user&&e.state.threeDayData&&e.state.liveGrowData)switch(e.state.mainContent){case"grows":return r.a.createElement(Z,{refreshGrows:e.refreshGrows,setJournalID:e.setJournalID,setGrow:e.setGrow,user:e.state.user,grow:e.state.currentGrow,growID:e.state.growID,userGrows:e.state.userGrows,liveGrowData:e.state.liveGrowData,rawGrowData:e.state.threeDayData});case"journals":return r.a.createElement(j,{setJournalID:e.setJournalID,journalID:e.state.journalID,userJournals:e.state.userJournals});case"lifetime":return r.a.createElement(ee,{postLifetimeData:e.postLifetimeData,getMonthChunkData:e.getMonthChunkData,user:e.state.user,lifetimeData:e.state.lifetimeData});default:return r.a.createElement(Q,{setFirebaseUser:e.setFirebaseUserPrefs,userGrows:e.state.userGrows,user:e.state.user,threeDayData:e.state.threeDayData,liveGrowData:e.state.liveGrowData})}else switch(e.state.mainContent){case"signin":return r.a.createElement(D,{gotoSignUp:e.setMainContent});case"signup":return r.a.createElement(w,{gotoSignIn:e.setMainContent});default:return r.a.createElement(D,{gotoSignUp:e.setMainContent})}}()))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},70:function(e,t,a){e.exports=a.p+"static/media/co2svg.fc43d345.svg"},71:function(e,t,a){e.exports=a.p+"static/media/tvoc-svg.86ee762c.svg"}},[[244,1,2]]]);
//# sourceMappingURL=main.f4831add.chunk.js.map